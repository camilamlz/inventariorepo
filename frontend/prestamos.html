<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Préstamo</title>
    <link rel="stylesheet" href="assets/css/formularios.css">
</head>
<body>
    <h2>Registro de Préstamo</h2>
    <form id="registroPrestamoForm">
        <label for="idEmpleadoDocente">ID Empleado/Docente:</label>
        <input type="number" id="idEmpleadoDocente" name="idEmpleadoDocente" required><br><br>
        
        <label for="idEquipo">ID Equipo:</label>
        <input type="number" id="idEquipo" name="idEquipo" required><br><br>
        
        <label for="fechaSolicitud">Fecha de Solicitud:</label>
        <input type="date" id="fechaSolicitud" name="fechaSolicitud" required><br><br>
        
        <label for="fechaEntrega">Fecha de Entrega:</label>
        <input type="date" id="fechaEntrega" name="fechaEntrega"><br><br>
        
        <label for="fechaRetiro">Fecha de Retiro:</label>
        <input type="date" id="fechaRetiro" name="fechaRetiro"><br><br>
        
        <label for="direccionEntrega">Dirección de Entrega:</label>
        <input type="text" id="direccionEntrega" name="direccionEntrega" required><br><br>
        
        <label for="estado">Estado:</label>
        <select id="estado" name="estado" required>
            <option value="pendiente">Pendiente</option>
            <option value="aprobado">Aprobado</option>
            <option value="rechazado">Rechazado</option>
            <option value="finalizado">Finalizado</option>
        </select><br><br>
        
        <label for="aprobadoPor">Aprobado Por:</label>
        <input type="number" id="aprobadoPor" name="aprobadoPor" required><br><br>
        
        <button type="submit">Registrar Préstamo</button>
    </form>

    <script>
        document.getElementById('registroPrestamoForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Evitar que el formulario se envíe por defecto

            // Obtener los valores de cada campo del formulario
            const idEmpleadoDocente = document.getElementById('idEmpleadoDocente').value;
            const idEquipo = document.getElementById('idEquipo').value;
            const fechaSolicitud = document.getElementById('fechaSolicitud').value;
            const fechaEntrega = document.getElementById('fechaEntrega').value;
            const fechaRetiro = document.getElementById('fechaRetiro').value;
            const direccionEntrega = document.getElementById('direccionEntrega').value;
            const estado = document.getElementById('estado').value;
            const aprobadoPor = document.getElementById('aprobadoPor').value;

            // Crear un objeto con los datos del préstamo
            const prestamoData = {
                id_empleado_docente: idEmpleadoDocente,
                id_equipo: idEquipo,
                fecha_solicitud: fechaSolicitud,
                fecha_entrega: fechaEntrega,
                fecha_retiro: fechaRetiro,
                dirección_entrega: direccionEntrega,
                estado: estado,
                aprobado_por: aprobadoPor
            };

            // Mostrar los datos del formulario en la consola del navegador
            console.log('Datos del préstamo a enviar:', prestamoData);

            // Enviar los datos al backend
            fetch('http://127.0.0.1:3000/prestamos', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(prestamoData)
            })
            .then(response => {
                if (response.ok) {
                    alert('Préstamo registrado exitosamente');
                    // Redireccionar a otra página si es necesario
                    window.location.href = '/otra-pagina.html';
                } else {
                    throw new Error('Error al registrar préstamo');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Ocurrió un error al registrar préstamo');
            });
        });
    </script>
</body>
</html>
